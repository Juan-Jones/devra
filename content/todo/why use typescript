<template>
  <div class="todo">
    <h1>Todos</h1>
    
    <input v-model="inputText" placeholder="Todo item" />
    <input v-model="inputRepeat" />
    <button @click="addTodo()">+</button>
    
    <ul v-if="todoList">
      <li v-for="todo in todoList.list" :key="todo">
        <span>{{todo.text}}</span>
        <span>{{todo.repeat}}</span>
        <span>X</span>
      </li>
    </ul>

    <br />
    <!-- <button @click="retrieve('rafed')">Bonga</button> -->
    <!-- <p>Got: {{ output }}</p> -->
  </div>
</template>

<script>
export default {
  name: 'todo',
  data() {
    return {
      todoList: {
        "list":[]
      },
      inputText: "",
      inputRepeat: "",
    };
  },
  mounted() {
    var list = this.retrieve('TODOLIST');
    if (!list) {
      list = [];
    }
    this.todoList.list = list;
  },
  methods: {
    store: function(key, value) {
      chrome.storage.local.set({ [key]: value }, function() {
        console.log(key + '-> is set to ' + value);
      });
    },
    retrieve: function(key) {
      var self = this;
      chrome.storage.local.get([key], function(result) {
        self.todoList.list = result[key];
      });
    },

    addTodo: function() {
      if(this.checkEmpty()){
        return;
      }

      var todo = {
        text: this.inputText,
        repeat: this.inputRepeat,
      };
      this.todoList.list.push(todo);
      this.store('TODOLIST', this.todoList);
      this.clearInput();
    },
    deleteTodo: function() {},
    clearInput: function() {
      (this.inputText = ''), (this.inputRepeat = '');
    },
    checkEmpty: function(){
      return (
        this.inputText.trim().length == 0 || 
        this.inputRepeat.trim().length == 0
      )
    }
  },
};
</script>

<style scoped>
</style>